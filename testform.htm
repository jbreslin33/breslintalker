<html>
<head><basefont face="Arial"></head>
<body>
<h2>Address Book</h2>

<?
// form not yet submitted
// display form
if (!$submit)
{
?>
	<form action="<? echo $_SERVER['PHP_SELF']; ?>" method="POST">
	Name:<br>
	<input name="name" type="text" size="50">
	<p>
	Address:<br>
	<textarea name="address" rows="6" cols="40"></textarea>
	<p>
	Tel:<br>
	<input name="tel" type="text" size="10">
	<p>
	Email:<br>
	<input name="email" type="text" size="30">
	<p>
	<input type="submit" name="submit" value="Add">
	</form>
<?
}
else
{
	// form submitted
	// prepare to insert data
	
	// database access parameters
	// alter this as per your configuration
	$host = "localhost";
	$user = "postgres";
	$pass = "postgres";
	$db = "test";
	
	// open a connection to the database server
	$connection = pg_connect("host=$host dbname=$db user=$user
password=$pass");
	
	if (!$connection)
	{
		die("Could not open connection to database server");
	}
	
	// error checks on form submission go here
	
	// generate and execute a query
	$query = "INSERT INTO addressbook VALUES
(nextval('addressbook_id_seq'), '$name', '$address', '$tel', '$email')";
	$result = pg_query($connection, $query) or die("Error in query:
$query. " . pg_last_error($connection));
	
	echo "Data successfully added.";
	
	// close database connection
	pg_close($connection);
}
?>
</body>
</html>